<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="UTF-8"/><title>White labeling</title><meta name="generator" content="Adobe RoboHelp 2019"/><link rel="stylesheet" href="../assets/css/default.css"/><link rel="stylesheet" href="../assets/css/PortaBilling_Admin_Guide_MR82.css"/></head><body><div><ul data-start="447" xmlns=""><li><h2><a id="_Toc31205472"></a>White labeling</h2><p>Using the brandpane feature you can customize your system on a per-environment basis to display your company name and logo on every web page. </p><p> </p><p>Every realm within the environment (e.g. admin, customer, vendor, cc_staff, etc.) can be modified by using a separate template. Brandpane templates are stored in the database and are periodically cached to ~porta-admin/apache/brandpane.</p><p> </p><p>To use the brandpane feature you will need to create an appropriate template file hierarchy. Do NOT use ~porta-admin/apache/brandpane for that as it is periodically updated by the caching procedure. Instead, use any temporary directory (e.g. /home/demoroot/tmp/bp).</p><h4>Brandpane file hierarchy</h4></li><li>First-level sub-directories represent environments. The name of a sub-directory must be ‘default’ (for an unspecified environment) or ‘env_#’ (where # is i_env number). Sub-directory ‘default’ is required. </li><li>Second-level sub-directories represent realms, named as in configuration (admin, accounts, cc_staff, customer, vendor, representative, etc.). Sub-directory ‘admin’ is required.</li><li>Every sub-directory must contain at least one file named ‘brandpane.tmpl,’ which is an ordinary HTML file. Additional files (images and CSS) are allowed.<p> </p><p></p><h4>Brandpane template selection order </h4><p>Brandpane is searched and applied in the following order:</p></li><li>env_$I_ENV/$REALM </li><li>default/$REALM </li><li>env_$I_ENV/admin </li><li>default/admin</li></ul><p><br/>‎<span>$I_ENV and $REALM are the current environment number and name of the realm. Steps 3 and 4 are not executed if the current realm is ‘admin.’</span></p><h4>Create new brandpane templates</h4><p>Follow the steps below to create a new brandpane template:</p><ol data-start="1" xmlns=""><li>The template’s file hierarchy should be created in a temporary directory (e.g. in /home/demoroot/tmp/bp). Log in to the server with the admin instance assigned to it and type:<p> </p><p>cd /home/demoroot/tmp/ </p><p>mkdir bp</p><p> </p></li><li>Create a proper brandpane file hierarchy and HTML components according to your requirements. Edit files brandpane.tmpl (a sample file is shown below).<p> </p><p>&lt;table width=100% border=&quot;0&quot; align=&quot;left&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; bgcolor=&quot;white&quot;&gt;</p><p>  &lt;tr&gt;</p><p>    &lt;td width=&quot;100%&quot;&gt;</p><p>     &lt;img src=&quot;/brandpane/default/admin/mylogo.gif&quot;&gt;</p><p>    &lt;/td&gt;</p><p>  &lt;/tr&gt;</p><p>&lt;/table&gt;</p><p> </p><p>Note that images must include a full path, relative to the Document Root (e.g. &quot;/brandpane/default/admin/my-logo.jpg&quot;).</p><p> </p></li><li>Import the brandpane into the database:<p> </p><p> </p></li><li>Activate the brandpane feature on the Configuration server web interface (the BrandPane_Enabled option).</li></ol><h4>Modify existent brandpane templates</h4><p>To change an already existent brandpane template, export it from the database to a temporary directory, make your desired modifications and then import it back to the database:</p><ol data-start="1" xmlns=""><li>Export brandpane templates into temporary directory:<p> </p><p>impexp_templates.pl -e -brandpane --path=/home/demoroot/tmp/bp </p><p> </p></li><li>Edit files, add / remove images, styles, etc.:<p> </p><p>nano /home/demoroot/tmp/bp/default/admin/brandpane.tmpl  </p><p> </p></li><li>Import brandpane templates back into the database:<p> </p><p>impexp_templates.pl -i -brandpane --path=/home/demoroot/tmp/bp</p><p> </p></li><li>Wait until Apache updates the cached brandpane templates.<p> </p></li><li>Clear the temporary directory:</li></ol><p> </p><p>rm -rf /home/demoroot/tmp/bp</p><h4>Remove existent brandpane templates</h4><p>To remove already existent brandpane templates, find the appropriate template in the database and remove it:</p><p> </p><ol data-start="1" xmlns=""><li>Find the brandpane template number in the database:<p> </p><p>impexp_templates.pl -l -db</p><p> </p><p>A command output example is shown below. Note that the template’s name is also its realm.</p><p> </p><p></p></li><li>Remove the template with the appropriate number:<p> </p><p>sudo -u -www impexp_templates.pl -d -t=122</p><p> </p></li><li>Remove the template from the file system on every admin instance of the web cluster:</li></ol><p> </p><p>rm -r /home/porta-admin/apache/brandpane/$I_ENV/$REALM</p><p> </p><p>$I_ENV and $REALM are the current environment number and name of the realm. </p><h4>Brandpane for self-care interfaces </h4><p>The brandpane functionality for self-care interfaces works similarly to other realms. It is configurable and can be turned on / off on the Configuration server via the ShowBrandPane option. The only difference between them is that the brandpane template file for self-care interfaces must be in the HTML format. An example of the brandpane.html file is shown below:</p><p> </p><p>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;**</p><p>       <span> </span> &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;</p><p><span> </span>&lt;html&gt;</p><p><span> </span>&lt;head&gt;</p><p>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;**</p><p>&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=8&quot;&gt;**</p><p><span> </span>&lt;title&gt;Account Self-Care&lt;/title&gt;</p><p><span> </span>&lt;/head&gt;</p><p><span> </span>&lt;body style=&quot;background-color:Tomato&quot;&gt;</p><p>&lt;img alt=&quot;text&quot; src=&quot;/brandpane/env_3/customer/logo.png&quot;&gt;</p><p><span> </span>&lt;/body&gt;</p><p><span> </span>&lt;/html&gt;</p><p> </p><p>The look and feel of the self-care interfaces’ brandpane can be adjusted by modifying the CSS entries in the brandpane.css file (which should be linked to the brandpane.html file).  For example, the following code changes the default brand pane height:    </p><p> </p><p>.brandPane{</p><p>   height: 200px;</p><p>}</p><p> </p><p>If you need to customize the self-care interfaces’ brandpane in different ways for different customers or accounts, you can do this via the following variables: i_customer and i_account.  An example below shows how this can be done:</p><p> </p><p>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;</p><p>&lt;html&gt;</p><p>&lt;head&gt;</p><p>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;</p><p>&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=8&quot;&gt;</p><p>&lt;title&gt;Account Self-Care&lt;/title&gt;</p><p>&lt;/head&gt;</p><p>&lt;body style=&quot;background-color:Tomato&quot;&gt;</p><p>    &lt;table&gt;</p><p>        &lt;tr&gt;</p><p>            &lt;td&gt;</p><p>                &lt;h1&gt; Hello customer # &lt;%$i_customer%&gt; &lt;/h1&gt;</p><p>            &lt;/td&gt;</p><p>            &lt;td&gt;</p><p>% my $result = $i_customer % ( int(rand(9)) + 1);</p><p>&lt;% $result %&gt;</p><p>% if ( $result % 2 == 0 ) {</p><p>    &lt;img alt=&quot;&quot; src=&quot;/brandpane/env_3/customer/logo.png&quot;</p><p> </p><p>% } else {</p><p>    &lt;img alt=&quot;&quot; src=&quot;/brandpane/env_3/customer/logo1.png&quot; </p><p> </p><p>% }</p><p>            &lt;/td&gt;</p><p>        &lt;/tr&gt;</p><p>    &lt;/table&gt;</p><p> </p><p>&lt;/body&gt;</p><p>&lt;/html&gt;</p><p> </p><p> </p><p>&lt;%args&gt;</p><p>    $i_customer =&gt; undef</p><p>    $i_account =&gt; undef</p><p>&lt;/%args&gt;</p><p> </p><p>Thus, different logos will be displayed, depending on which customer has logged in to their self-care interface.</p><h3>Adding a reseller’s logo to the reseller’s customers’ self-care interfaces </h3><ol data-start="1" xmlns=""><li>Activate the brandpane feature as described in the topic above.</li><li>Configure an additional virtual web server which will run on the reseller’s domain name (e.g. www.supercall.com). </li><li>Include conditional statements in the brandpane component. These will analyze the domain name the customer is trying to access, and will then produce the company name and logo for your domain (www.sipcall.com), while for the reseller’s (www.supercall.com) the reseller’s name and logo will be produced. See the following example:</li></ol><p> </p><p>% if ($ENV{HTTP_HOST} =~ m/supercall.com/) {</p><p>&lt;img src=&quot;/supercall.gif&quot;&gt;</p><p>% } else { # our default domain</p><p>&lt;img src=&quot;/sipcall.gif&quot;&gt;</p><p>% }</p><p><br/>‎<span> </span></p><p> </p></div><div><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><h1><a id="_Toc31205473"></a>Operations and integrations</h1><p> </p><p> </p><p><a id="_Troubleshooting_Tools"></a><br/>‎<a id="_Toc133593942"></a> <a id="_Toc447696352"></a><a id="_Toc31205474"></a><span>Troubleshooting Tools</span></p><p>Trace session functionality is an efficient tool that allows user sessions to be traced and simplifies troubleshooting for administrators. </p><p> </p><p>The key features of trace session functionality are:</p><ul data-start="460" xmlns=""><li>A single page for session search and display; </li><li>Merged SIP and billing logs to provide an entire overview of the session flow; </li><li>General information about a session in the form of a diagram between the main participants (e.g. SIP phones and PortaSwitch®) with the issue description and troubleshooting instructions for the most common issues; and</li><li>The ability to switch to the advanced log view if deeper investigation is required (e.g. to review the call flow among nodes within the PortaSwitch® cluster).<p> </p><p>For instance, on a call with an administrator, John Doe (12103355787) wants to find out why he cannot call 18660333777. The administrator opens the trace session page and searches the session using the account number and time interval. On the log viewer page, he sees that John Doe is not allowed to call the destination because it is forbidden.<br/>‎<br/>‎<span><img src="../assets/images/PortaBilling_Admin_Guide_MR82_files/image281.png" width="460.2" height="371.2" alt="Basic view call diagram."/></span></p><p> </p><p>For backward compatibility, an administrator can access billing logs on the old web interface by clicking the Old UI icon.</p><p> </p><p>This feature drastically simplifies troubleshooting and reduces the load on your administrative staff. </p><p> </p><p>Please refer to the Troubleshooting section of the <a href="https://www.portaone.com/handbook/index.htm"><span><span>Unified PortaSwitch</span></span></a></p><p><a href="https://www.portaone.com/handbook/index.htm">Handbook Collection</a> for more troubleshooting tips.</p><p> </p></li></ul></div></body></html>