<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="UTF-8"/><title>Tools for prevention of VoIP fraud</title><meta name="generator" content="Adobe RoboHelp 2019"/><link rel="stylesheet" href="../assets/css/default.css"/><link rel="stylesheet" href="../assets/css/PortaBilling_Admin_Guide_MR82.css"/></head><body><div><h2><a id="_Toc31205438"></a>Tools for prevention of VoIP fraud</h2><p>PortaSwitch® supports a set of tools to prevent VoIP fraud, i.e. a situation where an attacker uses credentials stolen from a customer’s IP PBX or end-point and sends unauthorized voice traffic to your network. </p><p> </p><p>There are two main approaches for distinguishing between the activity of a legitimate user and a hacker:</p><ul data-start="318" xmlns=""><li>Deviation in usage patterns.</li><li>Deviation in the location from which the service is used (geo-IP).<p> </p><p>The current version of the fraud protection module in PortaSwitch uses the location deviation method. This enables prevention of the majority of attacks without allowing a single fraudulent call to pass through, so there is zero loss for the service provider (or the customer). We plan to add real-time analysis of usage patterns in the next releases, to allow even better control and proactive prevention of those rare scenarios where location analysis may not yield sufficient results.</p><h3><a id="_Geo-IP_fraud_prevention"></a>Geo-IP fraud prevention</h3><p>If a hacker obtains the valid credentials of one of your customers, they can then send a call from their network using this username and password and even the identification of the SIP phone type. The only piece of information that cannot be easily changed by a hacker is their actual IP address. Although it is not always possible to determine a user’s exact location (e.g. street address) from their IP address, information regarding the country and the ISP that owns the IP address (and leases it to the end user) can be determined in the overwhelming majority of cases by using the database of IP address assignments (geo-IP database).</p><p> </p><p>The key element in geo-IP fraud prevention is the assumption that, under normal circumstances, the majority of users will use your service from the same country (and the same region in that country). For instance, a VoIP user in Barcelona, Spain, connects to the Internet via DSL provided by Telefonica. Although the user’s IP address is assigned dynamically by the ISP and may change, the “location” of that address will always point back to Spain. Even if the user changes the ISP to Orange, their IP address will still refer to Spain. Usually, larger customers who use SIP trunking services are the primary target for hackers, since they have higher credit limits and are authorized to send larger numbers of simultaneous calls. By using the credentials of such a customer, a hacker can send a significant amount of traffic in a relatively short time period. Fortunately, geo-IP fraud prevention is especially accurate for this type of customers. A residential user may take his SIP phone with him to a different country while on vacation, but it is very unlikely that a company will frequently move their office (and IP PBX) to a different country. </p><p> </p><p>When launching the service, the service provider creates one or more Geo / Risk Profiles. Each profile divides the list of all the countries in the world into three zones:</p></li><li>Trustful – A country (or countries) where users intend to use the service. Service usage is allowed without restrictions.</li><li>Cautious – Countries where it would be unusual (but still possible on a relatively low number of calls) for a customer to use the service without screening. Then any attempt to make an outgoing call from a country listed here will be screened, where he or she must provide additional credentials to prove that this is indeed a legitimate user.<p>NOTE: The default number of calls that can be made without screening is 5. You can change this value on the Configuration server.</p></li><li>Paranoid – Any usage attempt from these countries will be treated as a potential security breach and immediately screened. The customer must provide additional credentials to prove that this is indeed a legitimate user.</li></ul><p> </p><p>Naturally, the actual selection will depend on the area where the service provider sells the service and what type of service it is. For instance, an ITSP selling business SIP trunking services in London may define the United Kingdom as the “trustful” service location, and everyplace else as cautious, since all of their customers are actually based in the UK. Another ITSP, selling residential VoIP calling via a dialing app on a smart phone will define the United Kingdom, France and Spain as trustful locations (since they actively advertise their product in these countries and most of their customers are there). In this case, the majority of countries in the world will be listed as “cautious.” Finally, those countries from which the service provider sees an increased amount of hacking attempts will be declared “paranoid.”</p><p> </p><p><img src="../assets/images/PortaBilling_Admin_Guide_MR82_files/image203.png" width="461.5" height="185.0" alt="Fraud protection"/></p><p> </p><p>Next, Geo-IP fraud detection can be enabled in individual products, thereby allowing IP verification to be performed for all accounts, using this product. This allows you to apply Geo-IP verification to business and residential VoIP products, and skip it for other products (for backward compatibility or simply because it does not fit the business model, for instance for a service similar to Skype, where users can register and use the service anywhere in the world.</p><h4>Alerts about suspicious activities</h4><p>Time is critically important when a fraudulent incident occurs. The sooner one acts, the better chance they have to mitigate possible losses.  </p><p> </p><p>PortaSwitch® provides notifications to alert customers whenever the following events take place:</p><ul data-start="1.349" xmlns=""><li><ul data-start="1.349"><li>A call made from a customer’s account originates from a location known for high fraud potential and is therefore redirected to the screening IVR. The account’s status is changed to Screened.</li><li>A call made from a customer’s account originates from a location known for high fraud potential and is therefore immediately rejected. The account’s status is changed to Quarantined.</li></ul></li></ul><p> </p><p>To automatically notify your customers about these events, the Fraud prevention group of notifications must be enabled in the customer class.</p><p> </p><p><img src="../assets/images/PortaBilling_Admin_Guide_MR82_files/image204.png" width="460.8" height="259.2" alt="Enable alerts for customers"/></p><p> </p><p>When customers are promptly notified about suspicious activities, they are able to detect fraud early and take necessary protective measures to avoid possible losses. </p><h3>Country blacklist</h3><p>If the service provider wants to block calls originating from countries known for high fraud potential and the screening of calls by means of IVR is unacceptable, the Country blacklist functionality is the one to use. </p><p> </p><p>This functionality immediately drops calls that come from blacklisted countries. While fraudulent calls are rejected, calls originating from trusted countries come through without restrictions. </p><p> </p><p>Consider the following example. A customer who is a wholesale provider is located in Brazil. He wants to allow calls only originating from Brazil and deny calls originating from any other country. As many calls are sent simultaneously, screening calls by means of IVR is not optimal. </p><p> </p><p>For this customer, an administrator configures the Country blacklist to include all countries except Brazil and instructs PortaBilling to deny calls from these countries by default. </p><p> </p><p><img src="../assets/images/PortaBilling_Admin_Guide_MR82_files/image205.png" width="462.1" height="232.3" alt="geo-IP profile"/></p><p> </p><p><img src="../assets/images/PortaBilling_Admin_Guide_MR82_files/image206.png" width="460.2" height="224.0" alt="blacklist definition"/></p><p> </p><p>After a while, a Chinese hacker hacks this customer’s account and attempts to send calls to expensive destinations. PortaSwitch® detects that the account is attempting to send calls from a Chinese IP address and since China is present in the Country blacklist, these fraudulent calls are rejected, although calls from Brazil come through without any restrictions.      </p><p> </p><p>With Country blacklist functionality, service providers can offer more enhanced fraud protection to their customers – including the ability to consistently drop calls that originate from countries with a high fraud risk and to continue sending calls from trusted countries only.      </p><h3><a id="_Account_Attributes"></a>Account attributes</h3><p>The default setting for an account is “stationary,” meaning that the system expects the account to always be used in the same location. A change of country (location) is immediately considered a potential security breach. The alternative is to mark some accounts as “roaming,” in which case, the system allows for a greater number of location changes. This can be useful for customers who travel frequently and use mobile devices to communicate with clients. To reduce the amount of false alerts, a change in location will be considered acceptable in such cases. However, this will make it more difficult to detect actual fraudulent activity.</p><p> </p><p>Administrators can define a time interval during which end users are not supposed to make calls from different locations by configuring the Location change allowed every option in the product definition. </p><p> </p><p>For example, a location change is allowed every 240 minutes (i.e. every 4 hours). A call comes in and its location is detected as &quot;New York.&quot; For three days calls come from this number in New York, and then the account calls from Egypt. Merely an hour later, the same account calls from Bangladesh. Because only an hour had passed after the call from Egypt was made, the system considers the call from Bangladesh to be a potential security breach and screens it.</p><p> </p><p>This restriction works independently of the geo / risk profile assigned, and applies to location changes between countries as well as within a single country. It applies to roaming and stationary end users (the latter are allowed to change location within the country specified in the Current Location option for the customer / customer site / account).</p><p> </p><p>Two additional conditions may be introduced for an account:</p><ul data-start="323" xmlns=""><li>Screened – This means that some unusual activity has been detected for this user. An attempt to make an outgoing call will connect the user to a screening IVR, where he or she must provide additional credentials to prove that this is indeed a legitimate user.</li><li>Quarantined – This means that after being screened, this account was unable to supply valid credentials and is still generating a large number of call attempts. In order to reduce the load on your network, all such call attempts will automatically be blocked.<p> </p><p>Every account is assigned a “default” location. An administrator may override this country selection in order to allow a legitimate user to keep using the service in a country that is otherwise considered “unsafe.”</p><p></p><p><img src="../assets/images/PortaBilling_Admin_Guide_MR82_files/image207.png" width="461.5" height="236.2" alt="Screened"/></p><p> </p><p>Finally, each account is assigned its own unique “service unblock” code. This is provided to the customer upon sign-up, and can be used later to confirm that a legitimate customer is attempting to make a call, therefore allowing that call from a “suspicious” location.</p><p> </p><p><img src="../assets/images/PortaBilling_Admin_Guide_MR82_files/image208.png" width="460.8" height="236.2" alt="Service unblock code"/></p><h3>Call filtering</h3><p>For each outgoing call, the system analyzes the combination of the account’s status, its default location, and the location from which the call is made.</p></li><li>Any call from a quarantined account is immediately rejected.</li><li>A call from a screened account is redirected to the screening IVR.</li><li>If a call is made by a stationary account but the country of its current location does not match the default country, the call will be screened. If a stationary account does not yet have a default country assigned (e.g. a newly created account), the call is allowed only if the current country location is not on the High-risk list.</li><li>For roaming accounts, the call is allowed if the current country location matches the default country, or if the current country location is on the No Restrictions or Suspicious list.</li><li>In all other cases, the call will be screened.<h3>Screening IVR</h3><p>Clearly, blocking outgoing calls on any suspicion will create a negative experience for end users. A genuine customer may take his SIP phone on an overseas trip to see his family, or a businessman may need to make a very important call while transiting an airport in an “unusual” country. The screening IVR is designed to allow legitimate customers to continue making calls in situations where their activity is considered suspicious.</p><p> </p></li><li>The screening IVR announces that the user&#39;s call cannot be completed because of a potential risk of unauthorized usage.</li><li>It asks the user to re-enter the random 3-digit code he will hear. This is done to confirm that there is a live person on the line. (Hackers often use auto-dialers to test vulnerabilities in a network or generate calls to premium numbers.) </li><li>Then the user must enter the “service unblock” code provided to him when he signed up for the service. If the unblock code is entered correctly, the system will automatically connect the user to the originally dialed number (there is no need to re-enter the number).</li><li>If there are multiple unsuccessful attempts in the screening IVR, the account will be switched to “quarantined” status. This (along with the 3-digit “live human” verification) prevents a hacker from using a script to find the unblock code by “brute force” and continue sending traffic.</li></ul></div></body></html>