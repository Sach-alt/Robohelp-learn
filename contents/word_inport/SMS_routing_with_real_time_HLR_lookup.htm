<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="UTF-8"/><title>SMS routing with real-time HLR lookup</title><meta name="generator" content="Adobe RoboHelp 2019"/><link rel="stylesheet" href="../assets/css/default.css"/><link rel="stylesheet" href="../assets/css/PortaBilling_Admin_Guide_MR82.css"/></head><body><div><ul data-start="1.254" xmlns=""><li><ul data-start="1.254"><li><h2><a id="_Toc31205415"></a>SMS routing with real-time HLR lookup</h2><p>In mobile networks, message routing is based on a combination of the mobile country code (MCC) and the mobile network code (MNC). The MCC / MNC pair identifies the mobile carrier within the network and is used to build routing lists. Mobile carriers also operate with MCC / MNC codes to generate SMS pricing. </p><p> </p><p>To facilitate effective SMS delivery, message routing with real-time HLR lookup is introduced in PortaSwitch®. This means that PortaSwitch® requests subscriber information from the HLR (Home Location Registry) in real-time. It obtains the MCC / MNC codes of the destination number and then uses them for SMS delivery and billing. </p><p> </p><p>Thus, two aspects of SMS provisioning are considered in the scope of this document: MCC / MNC rate management and HLR lookup. </p><h4>MCC / MNC rate management</h4><p>The majority of mobile carriers operate with MCC / MNC codes for destinations and rates. Therefore, for convenience in working with these carriers, define destinations in the E.212-MCC-MNC format in PortaBilling®. </p><p> </p><p><img src="../assets/images/PortaBilling_Admin_Guide_MR82_files/image169.png" width="461.5" height="224.0" alt="MCC-MNC codes"/></p><p> </p><p>You can then upload your rates for these destinations in the tariffs for Messaging services and test the routing by using the Test Dialplan.</p><p>NOTE: To test message routing, make sure that HLR lookup is enabled on the Configuration server. </p><h4>HLR lookup</h4><p>HLR lookup serves two goals: to identify which mobile network the destination number belongs to and to perform correct SMS routing and billing.</p><p> </p><p>To identify which mobile network the destination number belongs to and to which mobile carrier route the message, PortaSIP® performs HLR lookup. This is done by sending an HLR lookup request to the external provider – <a href="http://www.hlr-lookups.com/">www.hlr-lookups.com</a>. This is the default HLR lookup provider, however, other providers can be integrated upon request. </p><p> </p><p>Upon successful HLR lookup, PortaSIP® receives the MCC and MNC codes for the destination number. The MCC / MNC pair defines which mobile carrier handles this number, even if it was ported from another carrier. </p><p> </p><p>The MCC / MNC codes are passed to PortaBilling® to compute a routing list and calculate vendor costs and user charges.   </p><h4>Configuration</h4><p>To provide SMS services using real-time HLR lookup, set up an account within <a href="http://www.hlr-lookups.com/">www.hlr-lookups.com</a> and configure the HLRNumberLookup module on the Configuration server.</p><p> </p><p>Please refer to the <a href="http://www.portaone.com/resources/handbook/index.htm">Unified PortaSwitch Handbook</a> collection for a detailed configuration description.</p><p>NOTE: Delays in message delivery to a carrier are possible. </p><p><img src="../assets/images/PortaBilling_Admin_Guide_MR82_files/Attention.gif" width="29.0" height="26.0" alt="Attention"/>If you enable HLR lookup, only vendors that support the E.212-MCC-MNC format will participate in the SMS routing. For customer / reseller tariffs you can define rates in either E.164 or E.212 format. However, to properly calculate charges, reseller and customer tariffs must have the same format. </p><p> </p><p>The support of MCC / MNC codes simplifies rate management and the configuration of SMS providers within PortaBilling®. Real-time HLR lookup assures the accuracy of SMS routing and billing. Consequently, you boost your competitiveness within the mobile telecommunications market and attract more customers. </p></li></ul></li></ul></div></body></html>